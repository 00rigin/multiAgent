"""
가드레일 패턴 설정

가드레일 시스템에서 사용하는 다양한 패턴들을 중앙에서 관리합니다.
"""

# 금지 키워드 패턴 (절대 차단)
FORBIDDEN_PATTERNS = [
    # 개인정보 관련
    r'\b(주민번호|주민등록번호|주민등록번호앞자리|주민등록번호뒤자리)\b',
    r'\b(신용카드|카드번호|카드번호앞자리|카드번호뒤자리)\b',
    r'\b(계좌번호|은행계좌|계좌정보)\b',
    r'\b(비밀번호|패스워드|password|pw|pwd)\b',
    r'\b(핀번호|PIN|pin)\b',
    r'\b(생년월일|생일|생일자)\b',
    
    # 불법/유해 내용
    r'\b(마약|대마|코카인|헤로인|암페타민|메스암페타민)\b',
    r'\b(자살|자해|목매달기|약물중독|약물남용)\b',
    r'\b(테러|폭탄|폭발물|무기제조|폭발물제조)\b',
    r'\b(해킹|크래킹|불법침입|바이러스제조|악성코드)\b',
    r'\b(불법도박|사설도박|온라인도박)\b',
    
    # 성적/외설적 내용
    r'\b(포르노|야동|성인영상|음란물|성인물)\b',
    r'\b(성매매|매춘|창녀|남창|성매매알선)\b',
    r'\b(성착취|아동성착취|성폭력)\b',
    
    # 폭력/차별
    r'\b(살인|폭력|구타|폭행|상해)\b',
    r'\b(인종차별|성차별|장애인차별|연령차별|종교차별)\b',
    r'\b(혐오|증오|비하|모욕|괴롭힘)\b',
    r'\b(집단따돌림|왕따|이지메)\b',
    
    # 기타 위험한 내용
    r'\b(자살방법|자살도구|자살사이트)\b',
    r'\b(불법약물|마약거래|약물거래)\b',
    r'\b(테러방법|폭탄제조법|무기제조법)\b',
]

# 경고 키워드 패턴 (주의 필요, 전문가 조언 권장)
WARNING_PATTERNS = [
    # 의학적 조언
    r'\b(진단|처방|약물|치료방법|치료법)\b',
    r'\b(병원|의사|약사|의료진|진료)\b',
    r'\b(증상|병|질병|병명|진단명)\b',
    r'\b(수술|시술|치료|재활)\b',
    
    # 법률 조언
    r'\b(소송|고소|고발|법적조치|법적대응)\b',
    r'\b(변호사|법무사|법원|재판|판결)\b',
    r'\b(계약|계약서|법적효력|법적구속력)\b',
    r'\b(손해배상|배상|보상|법적책임)\b',
    
    # 금융 조언
    r'\b(투자|주식|부동산|재테크|자산관리)\b',
    r'\b(대출|이자|금리|수익률|투자수익)\b',
    r'\b(보험|연금|퇴직금|연봉협상)\b',
    r'\b(세금|세무|절세|탈세|세무신고)\b',
    
    # 심리/상담
    r'\b(우울증|불안증|스트레스|트라우마)\b',
    r'\b(상담|심리치료|정신치료|정신건강)\b',
    r'\b(가족문제|부부문제|이혼|상속문제)\b',
]

# 스팸/피싱 패턴 (의심스러운 키워드)
SPAM_PATTERNS = [
    # 당첨/상금 관련
    r'\b(당첨|상금|로또|복권당첨|경품당첨)\b',
    r'\b(상속|유산|돈|재산|돈벌이)\b',
    r'\b(비밀|기밀|특별|한정|독점)\b',
    r'\b(무료|공짜|할인|특가|무료체험)\b',
    
    # 긴급성/압박감 조성
    r'\b(지금|바로|즉시|긴급|마감)\b',
    r'\b(마지막기회|한정시간|기한|데드라인)\b',
    r'\b(놓치면안돼|후회|아깝다|기회)\b',
    
    # 개인정보 요구
    r'\b(개인정보|신원확인|본인인증|계정정보)\b',
    r'\b(주민번호|휴대폰번호|전화번호|주소)\b',
    r'\b(계좌번호|카드번호|비밀번호|인증번호)\b',
    
    # 의심스러운 링크/첨부파일
    r'\b(클릭|다운로드|설치|실행|확인)\b',
    r'\b(링크|URL|사이트|웹사이트|홈페이지)\b',
    r'\b(첨부파일|파일|문서|이미지|동영상)\b',
]

# 이메일 특화 패턴
EMAIL_SPECIFIC_PATTERNS = {
    # 이메일 주소 형식
    "email_pattern": r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$',
    
    # 대량 발송 제한
    "max_recipients": 10,
    
    # 이메일 특화 금지 키워드
    "email_forbidden": [
        r'\b(스팸|광고|홍보|마케팅)\b',
        r'\b(대량발송|벌크메일|매스메일)\b',
        r'\b(피싱|사기|사칭|위장)\b',
    ]
}

# 캘린더 특화 패턴
CALENDAR_SPECIFIC_PATTERNS = {
    # 캘린더 특화 금지 키워드
    "calendar_forbidden": [
        r'\b(불법모임|비밀모임|금지된모임)\b',
        r'\b(마약거래|약물거래|불법거래)\b',
        r'\b(테러|폭력|범죄)\b',
    ]
}

# 검색 특화 패턴
SEARCH_SPECIFIC_PATTERNS = {
    # 검색 특화 금지 키워드
    "search_forbidden": [
        r'\b(해킹방법|크래킹방법|불법침입방법)\b',
        r'\b(마약제조|약물제조|불법약물)\b',
        r'\b(테러방법|폭탄제조|무기제조)\b',
    ]
}

# 가드레일 설정
GUARDRAIL_CONFIG = {
    # 스팸 패턴 임계값 (이 개수 이상이면 차단)
    "spam_threshold": 2,
    
    # 경고 패턴 임계값 (이 개수 이상이면 경고)
    "warning_threshold": 1,
    
    # 응답 메시지 템플릿
    "response_templates": {
        "forbidden": "죄송합니다. {reason} 안전상의 이유로 해당 요청을 처리할 수 없습니다.",
        "spam": "죄송합니다. {reason} 정상적인 요청으로 다시 시도해주세요.",
        "warning": "⚠️ 주의: {reason} 전문가와 상담하시는 것을 권장합니다.",
        "email_invalid": "유효하지 않은 이메일 주소가 포함되어 있습니다.",
        "email_bulk": "대량 이메일 발송은 제한됩니다. 수신자를 {max_recipients}명 이하로 제한해주세요.",
    },
    
    # 제안 메시지
    "suggestions": {
        "forbidden": ["안전한 주제로 대화를 이어가주세요."],
        "spam": ["정상적인 요청으로 다시 시도해주세요."],
        "warning": ["전문가와 상담하시는 것을 권장합니다."],
        "email": ["올바른 이메일 주소를 입력해주세요."],
    }
} 